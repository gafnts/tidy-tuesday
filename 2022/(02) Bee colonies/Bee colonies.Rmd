```{r}
pacman::p_load(tidyverse, here, sysfonts, cowplot)
```

# Bee colonies

## (a) Import data

```{r}
colony <- 
  read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/colony.csv") %>% 
  mutate_if(is.numeric, ~replace(., is.na(.), 0))

stressor <- 
  read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2022/2022-01-11/stressor.csv") %>% 
  mutate_if(is.numeric, ~replace(., is.na(.), 0))
```

## (b) Data wrangling

```{r}
plot <- 
  colony %>%
  mutate(
    months = case_when(
      months == "January-March" ~ "",
      months == "April-June" ~ "Q2",
      months == "July-September" ~ "Q3",
      months == "October-December" ~ "Q4",
    ),
    year = paste0(year, "", months)
  ) %>%
  select(-months) %>%
  group_by(year) %>%
  summarise(
    colony_n = sum(colony_n),
    colony_lost = sum(colony_lost),
    colony_reno = sum(colony_reno)
  ) %>%
  ungroup() %>%
  pivot_longer(-year)
```

## (c) Plot

```{r}
f1 <- "Nunito Sans Regular"
f2 <- "Nunito Sans Regular"
```

```{r}
p <- 
  plot %>% 
  ggplot(aes(x = year, y = value, fill = name)) +
  geom_col() + 
  scale_y_continuous(label = scales::comma,
                     breaks = seq(0, 8e6, by = 1e6)) + 
  scale_x_discrete(breaks = c(2015, 2016, 2017, 2018, 2019, 2020, 2021)) +
  theme(axis.title.x = element_blank(),
        axis.text.x = element_text(color = "#F2F2F2", size = 17, family = f2),
        axis.title.y = element_blank(),
        axis.text.y = element_text(color = "#F2F2F2", size = 17, family = f2),
        legend.title = element_blank(),
        legend.text = element_text(size = 7),
        plot.background = element_rect(fill = "#1D2026", color = NA),
        panel.background = element_rect(fill = "#1D2026"),
        panel.grid.major.x = element_blank(),
        panel.grid.minor.x = element_blank(),
        panel.grid.major.y = element_line(color = "#F2F2F2", linetype = "dashed", size = .2),
        panel.grid.minor.y = element_blank(),
        axis.ticks = element_line(size = 0),
        legend.position = "none",
        plot.margin = margin(6.3, 2, 2.3, 2, "cm"),
        panel.border = element_blank(),
        plot.tag.position = c(0.5, 1)) +
  scale_fill_manual(values = c("#A6325C", "#F272A1", "#62C3D9"))

ggdraw(p) +
  draw_label(
    "â€”",
    hjust = 0,
    x = .05,
    y = .95,
    size = 80,
    color = "#F2F2F2",
    fontfamily = f1
  ) +
  draw_label(
    "This is an awesome title that explains",
    hjust = 0,
    x = .05,
    y = .90,
    size = 35,
    color = "#F2F2F2",
    fontfamily = f1
  ) +
  draw_label(
    "something about bees",
    hjust = 0,
    x = .05,
    y = .85,
    size = 35,
    color = "#F2F2F2",
    fontfamily = f1
  ) +
  draw_label(
    "Getting there!",
    hjust = 0,
    x = .05,
    y = .79,
    size = 20,
    color = "gray",
    fontfamily = f1
  ) +
  draw_label(
    "Source: Source",
    hjust = 0,
    x = .74,
    y = .05,
    size = 20,
    color = "gray",
    fontfamily = f1
  )

ggsave(
  filename = "plot.png",
  path = here("2022", "(02) Bee colonies"),
  dpi = 320,
  height = 10,
  width = 10
)
```

```{r}
ggsave(
  filename = "plot.png",
  path = here("2022", "(02) Bee colonies"),
  dpi = 320,
  height = 10,
  width = 10
)
```
